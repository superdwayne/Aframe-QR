<!DOCTYPE html>
<html>
  <!-- include A-Frame obviously -->
  <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
 
<!-- include ar.js for A-Frame -->
<script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>
<script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
<script src="https://unpkg.com/aframe-animation-component@%5E3.2.x/dist/aframe-animation-component.min.js"></script>

<script>

// Component to allow for the audio to play once the GTLF loads 
AFRAME.registerComponent('loader', {
       init: function() {

        let audio = document.querySelector("#neigh");
        let loader = document.querySelector("#loadingEl")

         const sceneEl = this.el;

         sceneEl.addEventListener('model-loaded', e => {
// We check here if the GTLF has loaded then we play or pause the audio          
           console.log(e.detail.target.hasLoaded)
           if (e.detail.target.hasLoaded) {
            audio.play();
           } else {
            audio.pause();
              audio.currentTime = 0;
           }
  
         })
       }
     })

</script>

<body style='margin : 0px; overflow: hidden;'>
  <a-scene loader embedded arjs='detectionMode: mono_and_matrix; matrixCodeType: 3x3; ' >
  
      <a-assets >
        <audio  id="neigh" crossOrigin="anonymous" src="https://cdn-static.farfetch-contents.com/Content/UP/EXPERIENCE/Metaverse/Shortmusic.mp4">
        </audio>
        <a-entity >
          <a-asset-item id="tree" crossOrigin="anonymous" src="https://cdn-static.farfetch-contents.com/Content/UP/EXPERIENCE/Metaverse/DPM-S-Walking-v2.glb"></a-asset-item>
        </a-entity>
      </a-assets>

        <!-- <a-entity light="type: spot; angle: 90; color: #AFA; intensity: 3.5" ></a-entity> -->
      
        <a-entity 
        id="lightSphere"
        geometry="primitive: sphere; radius: 0.1; " material="shader: flat; opacity: 0" 
        light="type: point; color: green; intensity: 2; " rotation=" 0 45 0" position="0.5 1.8 -3"
        animation="property: position; to: 1 1.8 -3; dir: alternate; loop: true"></a-entity>

        <a-entity  scale="2 2 2" animation-mixer="clip: WALK" rotation="0 90 0" gltf-model="#tree" position='-2 -1 -5' gesture-handler></a-entity>
       
        <a-entity 
        id="lightSphere"
        geometry="primitive: sphere; radius: 0.1; " material="shader: flat; opacity: 0" 
        light="type: point; color: red; intensity: 2; " rotation=" 0 45 0" position="-1 1.8 -3"
        animation="property: position; to: 0.5 1.8 -3; dir: alternate; loop: true"></a-entity>
       
        <!-- <a-entity light="type: spot; angle: 45; color: #AFAAAF; intensity: 3.5" ></a-entity> -->
      
        <a-entity camera look-controls>

          
          <a-marker preset='custom' type="pattern" url='https://raw.githubusercontent.com/superdwayne/Assets/main/kl.patt'></a-marker>
      </a-entity> 

  </a-scene>
</body>
</html>